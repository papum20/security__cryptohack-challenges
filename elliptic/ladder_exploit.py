from utils_montgomery import multiply
from sage.all import *


p = 2**255 - 19
A = 486662
B = 1
E = lambda x, y: B*y**2 % p == (x**3 + A*x**2 + x) % p

Gx = 9
n = 0x1337c0decafe
# Q = nG


Gx = mod(Gx, p)
Gy = (Gx**3 + 486662*Gx**2 + Gx).sqrt()
G = [Gx, Gy]

assert E(Gx, Gy)

print(f'{G = }')

Q = multiply(G, n, p, A, B, E)
assert E(Q[0], Q[1])

print(f'{Q = }')
