from sage.all import *
from hashlib import sha1

from utils import sum, double, multiply


if __name__ == '__main__':

	p = 9739
	E	= lambda x, y: y**2 % p == (x**3 + 497*x + 1768) % p
	# derivate(x,y) = [x,y]
	dE	= lambda x, y: [2*y % p, (3*x**2 + 497) % p]

	G = (1804,5368)
	Qa = (815, 3190)
	nB = 1829

	S = multiply(Qa, nB, p, dE)

	hash = sha1(str(S[0]).encode()).hexdigest()
	print(hash)